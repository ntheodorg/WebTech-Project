<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generated Statistics</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.8.0/chart.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container">
    <canvas id="myChart"></canvas>
</div>


<script>
    let myChart = document.getElementById('myChart').getContext('2d');
    let colors = ['red', 'blue', 'green', 'gray', 'blue'];
    const data = {"62ac7b0b5730a4b04db710a8":{"name":"Gara","material_type":"Household-waste","quantity":200},"62ac7c935730a4b04db710d7":{"name":"Industriala","material_type":"Plastic","quantity":500},"62adc3f62cb3bdb817c6a2b0":{"name":"Gara","material_type":"Metal","quantity":5000},"62ae59ca5e2d53553e00a63f":{"name":"Gara","material_type":"Metal","quantity":4856},"62ae59ca5e2d53553e00a63e":{"name":"Gara","material_type":"Household-waste","quantity":6465},"62ae59ca5e2d53553e00a641":{"name":"Gara","material_type":"Paper","quantity":8646},"62ae59ca5e2d53553e00a640":{"name":"Gara","material_type":"Plastic","quantity":486},"62ae59f47c1ae095a4bc4721":{"name":"Gara","material_type":"Household-waste","quantity":535},"62ae59f47c1ae095a4bc4722":{"name":"Gara","material_type":"Metal","quantity":565},"62ae59f47c1ae095a4bc4723":{"name":"Gara","material_type":"Paper","quantity":565},"62ae5a39addc31f4795ce6b7":{"name":"Industriala","material_type":"Household-waste","quantity":54},"62ae5a39addc31f4795ce6b9":{"name":"Industriala","material_type":"Paper","quantity":1},"62ae5a39addc31f4795ce6b8":{"name":"Industriala","material_type":"Metal","quantity":69},"62b192da38036e3b8f1f8da6":{"name":"Industriala","material_type":"Plastic","quantity":300},"62b1fee5312b7c9ba951c495":{"name":"Industriala","material_type":"Household-waste","quantity":354634},"62b299bf87005b7eec65b5c5":{"name":"Industriala","material_type":"Metal","quantity":500},"62b299bf87005b7eec65b5c4":{"name":"Industriala","material_type":"Household-waste","quantity":500},"62b299bf87005b7eec65b5c7":{"name":"Industriala","material_type":"Paper","quantity":50},"62b299bf87005b7eec65b5c6":{"name":"Industriala","material_type":"Plastic","quantity":100}}
    let cartiere = []
    let processed = {}

    // Create cartiere list
    for(const collect of Object.values(data)){
        if(!cartiere.includes(collect.name)){
            cartiere.push(collect.name);
        }
        const index = cartiere.indexOf(collect.name);

        if(!processed[collect.material_type]){
            processed[collect.material_type] = {data: [], color: colors.pop()};
        }
        const dataList = processed[collect.material_type].data
        if(!dataList[index]){
            dataList[index] = collect.quantity;
        } else {
            dataList[index] += collect.quantity;
        }

    }

    let dataList =[]

    // Create dataList
    for(const [key, value] of Object.entries(processed)){
        console.log(key)
        dataList.push({
            label: key,
            data: value.data,
            borderWidth: 1,
            backgroundColor: value.color
        })
    }


    let MainChart = new Chart(myChart, {
        type:'bar',
        data: {
            labels: cartiere,
            datasets: dataList
        },
        options: {}
    })
</script>
</body>
</html>